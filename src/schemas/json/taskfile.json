{
  "$schema": "http://json-schema.org/draft-07/schema",
  "definitions": {
    "3": {
      "cmd": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "$ref": "#/definitions/3/cmd_call"
          },
          {
            "$ref": "#/definitions/3/task_call"
          }
        ]
      },
      "cmd_call": {
        "additionalProperties": false,
        "properties": {
          "cmd": {
            "description": "Command to run",
            "type": "string"
          },
          "ignore_error": {
            "description": "Prevent command from aborting the execution of task even after receiving a status code of 1",
            "type": "boolean"
          },
          "silent": {
            "description": "Silent mode disables echoing of command before Task runs it",
            "type": "boolean"
          }
        },
        "required": ["cmd"],
        "type": "object"
      },
      "cmds": {
        "items": {
          "$ref": "#/definitions/3/cmd"
        },
        "type": "array"
      },
      "dynamic_var": {
        "properties": {
          "additionalProperties": false,
          "sh": {
            "description": "The value will be treated as a command and the output assigned",
            "type": "string"
          }
        },
        "type": "object"
      },
      "env": {
        "$ref": "#/definitions/3/vars"
      },
      "precondition": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "$ref": "#/definitions/3/precondition_obj"
          }
        ]
      },
      "precondition_obj": {
        "properties": {
          "msg": {
            "description": "Failure message to display when the condition fails",
            "type": "string"
          },
          "sh": {
            "description": "Command to run. If that command returns 1, the condition will fail",
            "type": "string"
          }
        },
        "type": "object"
      },
      "run": {
        "enum": ["always", "once", "when_changed"],
        "type": "string"
      },
      "task": {
        "additionalProperties": false,
        "properties": {
          "cmds": {
            "$ref": "#/definitions/3/cmds",
            "description": "A list of commands for this task"
          },
          "deps": {
            "description": "Declaring tasks here that should run automatically before this task",
            "items": {
              "oneOf": [
                {
                  "type": "string"
                },
                {
                  "$ref": "#/definitions/3/task_call"
                }
              ]
            },
            "type": "array"
          },
          "desc": {
            "description": "Provides a description for this task. Used by the --list/-l flag",
            "type": "string"
          },
          "dir": {
            "description": "Defines where the task will run. Defaults to the directory of the Taskfile",
            "type": "string"
          },
          "env": {
            "$ref": "#/definitions/3/env",
            "description": "Environment variables for this task"
          },
          "generates": {
            "description": "List the files generated by this task. Will be used to prevent running the task again if nothing changed. Can be a file of a file pattern.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "ignore_error": {
            "description": "Prevent Task from aborting the execution of tasks even after receiving a status code of 1",
            "type": "boolean"
          },
          "interactive": {
            "description": "Indicates that this task runs an interactive CLI application",
            "type": "boolean"
          },
          "label": {
            "description": "Override the task name print on summary, can be interpolated with variables",
            "type": "string"
          },
          "method": {
            "default": "none",
            "description": "Defines which method is used to check the task is up-to-date. timestamp will compare the timestamp of the sources and generates files. checksum will check the checksum (You will probably want to ignore the .task folder in your .gitignore file). none skips any validation and always run the task",
            "enum": ["none", "checksum", "timestamp"],
            "type": "string"
          },
          "preconditions": {
            "description": "Defines a list of conditions to be true for the task to run",
            "items": {
              "$ref": "#/definitions/3/precondition"
            },
            "type": "array"
          },
          "prefix": {
            "description": "Defines a string to prefix the output of tasks running in parallel. Only used when the output mode is prefix",
            "type": "string"
          },
          "run": {
            "$ref": "#/definitions/3/run",
            "description": "Controls whether or not this task runs when called by multiple deps or cmds."
          },
          "silent": {
            "description": "Silent mode disables echoing of commands before Task runs it",
            "type": "boolean"
          },
          "sources": {
            "description": "List the source files for this task. Will be used to prevent running the task again if nothing changed. Can be a file of a file pattern.",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "status": {
            "description": "Define a sequence of tests as status of this task. If no error is returned (exit status 0), the task is considered up-to-date",
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "summary": {
            "description": "Provides a summary for this task. Used by the --summary flag",
            "type": "string"
          },
          "vars": {
            "$ref": "#/definitions/3/vars",
            "description": "Declare variables for this task"
          }
        },
        "type": "object"
      },
      "task_call": {
        "properties": {
          "task": {
            "description": "Name of the task to run",
            "type": "string"
          },
          "vars": {
            "$ref": "#/definitions/3/vars",
            "description": "Values passed to the task called"
          }
        },
        "type": "object"
      },
      "tasks": {
        "patternProperties": {
          "^.*$": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "oneOf": [
                    {
                      "type": "string"
                    },
                    {
                      "$ref": "#/definitions/3/task_call"
                    }
                  ]
                },
                "type": "array"
              },
              {
                "$ref": "#/definitions/3/task"
              }
            ]
          }
        },
        "type": "object"
      },
      "vars": {
        "patternProperties": {
          "^.*$": {
            "anyOf": [
              {
                "type": ["boolean", "integer", "null", "number", "string"]
              },
              {
                "$ref": "#/definitions/3/dynamic_var"
              }
            ]
          }
        },
        "type": "object"
      }
    }
  },
  "description": "JSON Schema for Taskfile files.",
  "oneOf": [
    {
      "additionalProperties": false,
      "anyOf": [
        {
          "required": ["includes"]
        },
        {
          "required": ["tasks"]
        },
        {
          "required": ["includes", "tasks"]
        }
      ],
      "properties": {
        "dotenv": {
          "description": "Ask Task to include .env file",
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "env": {
          "$ref": "#/definitions/3/env",
          "description": "Declare environment variables globally"
        },
        "includes": {
          "description": "Imports other tasks from the provided taskfile. The tasks described in the given Taskfiles will be available with the informed namespace.",
          "patternProperties": {
            "^.*$": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "properties": {
                    "dir": {
                      "description": "On which directory the included Taskfile will run",
                      "type": "string"
                    },
                    "taskfile": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                }
              ]
            }
          },
          "type": "object"
        },
        "method": {
          "default": "checksum",
          "description": "Defines which method is used to check the task is up-to-date. (default: checksum)",
          "enum": ["none", "checksum", "timestamp"],
          "type": "string"
        },
        "output": {
          "default": "interleaved",
          "description": "Defines how the STDOUT and STDERR are printed when running tasks in parallel. The interleaved output prints lines in real time (default). The group output will print the entire output of a command once, after it finishes, so you wonâ€™t have live feedback for commands that take a long time to run. The prefix output will prefix every line printed by a command with [task-name] as the prefix, but you can customize the prefix for a command with the prefix: attribute.",
          "enum": ["interleaved", "group", "prefixed"],
          "type": "string"
        },
        "run": {
          "$ref": "#/definitions/3/run",
          "description": "Default behavior when tasks are executed as part of deps or other cmds"
        },
        "silent": {
          "description": "Silent mode disables echoing of commands for all tasks",
          "type": "boolean"
        },
        "tasks": {
          "$ref": "#/definitions/3/tasks",
          "description": "Defines your tasks"
        },
        "vars": {
          "$ref": "#/definitions/3/vars",
          "description": "Declare variables globally"
        },
        "version": {
          "anyOf": [
            {
              "enum": [3],
              "type": "number"
            },
            {
              "enum": ["3"],
              "type": "string"
            }
          ],
          "description": "Specify the Taskfile format that this file conforms to."
        }
      },
      "required": ["version"],
      "type": "object"
    }
  ],
  "title": "Taskfile YAML Schema"
}
