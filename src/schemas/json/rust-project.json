{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "JSON schema for non-Cargo based Rust projects",
    "type": "object",
    "definitions": {
        "crate": {
            "type": "object",
            "properties": {
                "display_name": {
                    "type": "string",
                    "description": "Crate name used for display purposes, without affecting semantics."
                },
                "root_module": {
                    "type": "string",
                    "description": "Path to the root module of the crate."
                },
                "edition": {
                    "type": "string",
                    "description": "Edition of the crate.",
                    "enum": [ "2015", "2018", "2021" ]
                },
                "deps": {
                    "type": "array",
                    "description": "Crate dependencies.",
                    "items": {
                        "$ref": "#/definitions/dep"
                    }
                },
                "version": {
                    "type": "string",
                    "description": "The crate's version",
                    "pattern": "^([0-9]+)\\.([0-9]+)\\.([0-9]+)(?:-([0-9A-Za-z-]+(?:\\.[0-9A-Za-z-]+)*))?(?:\\+[0-9A-Za-z-]+)?$"
                },
                "is_workspace_member": {
                    "type": "boolean",
                    "description": "Whether this crate should be treated as a member of the current \"workspace\"."
                },
                "source": {
                    "type": "object",
                    "description": "(Super)set of `.rs` files comprising this crate.",
                    "properties": {
                        "include_dirs": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        },
                        "exclude_dirs": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        }
                    },
                    "required": [
                        "include_dirs",
                        "exclude_dirs"
                    ]
                },
                "cfg": {
                    "type": "array",
                    "description": "The set of cfgs activated for a given crate.",
                    "items": {
                        "type": "string"
                    }
                },
                "target": {
                    "type": "string",
                    "description": "Target triple for this crate."
                },
                "env": {
                    "type": "object",
                    "description": "Environment variables, used for the `env!` macro",
                    "patternProperties": {
                        "^.*$": {
                            "type": "string"
                        }
                      },
                    "additionalProperties": false
                },
                "is_proc_macro": {
                    "type": "boolean",
                    "description": "Whether the crate is a proc-macro crate."
                },
                "proc_macro_dylib_path": {
                    "type": "string",
                    "description": "For proc-macro crates, path to compiled proc-macro (.so file)."
                },
                "repository": {
                    "type": "string",
                    "description": "URL to the source repository of the crate."
                }
            },
            "required": [
                "root_module",
                "edition",
                "deps"
            ]
        },
        "dep": {
            "type": "object",
            "properties": {
                "crate": {
                    "type": "integer",
                    "description": "Index of a crate in the `crates` array."
                },
                "name": {
                    "type": "string",
                    "description": "Name as should appear in the (implicit) `extern crate name` declaration."
                }
            },
            "required": [
                "crate",
                "name"
            ]
        }
    },
    "properties": {
        "sysroot": {
            "type": "string",
            "description": "Path to sysroot."
        },
        "sysroot_src": {
            "type": "string",
            "description": "Path to the directory with source code of sysroot crates."
        },
        "crates": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/crate"
            },
            "description": "The set of crates comprising the current project."
        }
    },
    "required": [
        "crates"
    ]
}