{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "is-parallel-true": {
      "properties": {
        "parallel": {
          "enum": [true]
        }
      }
    },
    "parallel-requires-foreach-to-be-true": {
      "anyOf": [
        {
          "not": {
            "$ref": "#/definitions/is-parallel-true"
          }
        },
        {
          "properties": {
            "foreach": {
              "enum": [true]
            }
          },
          "required": ["foreach"]
        }
      ]
    }
  },
  "description": "The hemtt.json or hemtt.toml file is used to configure your HEMTT Project. All examples are done using JSON, but both files support every feature of HEMTT. hemtt.toml will be used if both files are present.",
  "properties": {
    "author": {
      "$id": "#/properties/author",
      "default": "",
      "description": "Author of the project.",
      "examples": ["ACE Mod Team"],
      "pattern": "^(.*)$",
      "title": "The Author Schema",
      "type": "string"
    },
    "exclude": {
      "$id": "#/properties/exclude",
      "default": null,
      "description": "HEMTT will exclude matching files when building.",
      "items": {
        "$id": "#/properties/exclude/items",
        "default": "",
        "examples": ["*.psd", "*.png", "*.tga"],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Exclude Schema",
      "type": "array"
    },
    "files": {
      "$id": "#/properties/files",
      "default": null,
      "description": "HEMTT will copy the files to the release directory after a successful release build. Supports glob patterns.",
      "items": {
        "$id": "#/properties/files/items",
        "default": "",
        "examples": ["mod.cpp", "logo.paa", "*.dll"],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Files Schema",
      "type": "array"
    },
    "folder_optionals": {
      "$id": "#/properties/folder_optionals",
      "default": false,
      "description": "HEMTT will by default build optionals into their own mod folders, which can be directly launched by the user. This can be turned off to build optional PBOs directly into optionals folder.",
      "examples": [false],
      "title": "The Folder_optionals Schema",
      "type": "boolean"
    },
    "headerexts": {
      "$id": "#/properties/headerexts",
      "default": null,
      "description": "HEMTT will apply specified header extensions to each PBO. Supports templating.",
      "items": {
        "$id": "#/properties/headerexts/items",
        "default": "",
        "examples": ["author=me"],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Headerexts Schema",
      "type": "array"
    },
    "include": {
      "$id": "#/properties/include",
      "default": null,
      "description": "HEMTT will include matching relative or absolute paths when building.",
      "items": {
        "$id": "#/properties/include/items",
        "default": "",
        "examples": ["./include"],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Include Schema",
      "type": "array"
    },
    "keyname": {
      "$id": "#/properties/keyname",
      "default": "",
      "description": "HEMTT will use the specified key name for .bikey and .biprivatekey names. Supports templating.",
      "examples": ["my_key"],
      "pattern": "^(.*)$",
      "title": "The Keyname Schema",
      "type": "string"
    },
    "modname": {
      "$id": "#/properties/modname",
      "default": "",
      "description": "HEMTT will use the specified mod name (without @) to form @mod folder. Supports templating.",
      "examples": ["my_mod"],
      "pattern": "^(.*)$",
      "title": "The Modname Schema",
      "type": "string"
    },
    "name": {
      "$id": "#/properties/name",
      "default": "",
      "description": "Long name of your project.",
      "examples": ["Advanced Banana Environment"],
      "pattern": "^(.*)$",
      "title": "The Name Schema",
      "type": "string"
    },
    "optionals": {
      "$id": "#/properties/optionals",
      "default": null,
      "description": "HEMTT will build the specified addons from the ./optionals folder.",
      "items": {
        "$id": "#/properties/optionals/items",
        "default": "",
        "examples": ["tracers", "particles"],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Optionals Schema",
      "type": "array"
    },
    "postbuild": {
      "$id": "#/properties/postbuild",
      "default": null,
      "items": {
        "$id": "#/properties/postbuild/items",
        "default": "",
        "examples": [""],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Postbuild Schema",
      "type": "array"
    },
    "prebuild": {
      "$id": "#/properties/prebuild",
      "default": null,
      "items": {
        "$id": "#/properties/prebuild/items",
        "default": "",
        "examples": [""],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Prebuild Schema",
      "type": "array"
    },
    "prefix": {
      "$id": "#/properties/prefix",
      "default": "",
      "description": "Prefix used for CBA macros and the release directory name.",
      "examples": ["ABE3"],
      "pattern": "^(.*)$",
      "title": "The Prefix Schema",
      "type": "string"
    },
    "releasebuild": {
      "$id": "#/properties/releasebuild",
      "default": null,
      "items": {
        "$id": "#/properties/releasebuild/items",
        "default": "",
        "examples": [""],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Releasebuild Schema",
      "type": "array"
    },
    "reuse_private_key": {
      "$id": "#/properties/reuse_private_key",
      "default": false,
      "description": "If set to true, HEMTT will use (and re-use) releases/keys/{keyname}.biprivatekey. It will be generated if it doesn't exist. The default behaviour is to generate a new private key each time and discard it immediately. HEMTT strongly recommends that you only re-use the key if you are making a client-side mod where it will not matter if clients are running different versions of the mod.",
      "examples": [false],
      "title": "The Reuse_private_key Schema",
      "type": "boolean"
    },
    "scripts": {
      "$id": "#/properties/scripts",
      "additionalProperties": {
        "$id": "#/properties/scripts/properties/",
        "allOf": [
          {
            "$ref": "#/definitions/parallel-requires-foreach-to-be-true"
          }
        ],
        "default": null,
        "properties": {
          "foreach": {
            "$id": "#/properties/scripts/properties//properties/foreach",
            "default": false,
            "description": "Scripts can be ran for each addons. Inside prebuild the script will be ran for each addon that HEMTT will build, including addons that will be skipped if they are already built. Inside postbuild and releasebuild only addons that were successfully built with be used, excluding addons that were skipped for being up to date.",
            "examples": [true],
            "title": "The Foreach Schema",
            "type": "boolean"
          },
          "parallel": {
            "$id": "#/properties/scripts/properties//properties/parallel",
            "default": false,
            "description": "Requires foreach to be true. If a script is thread safe parallel can be used to process multiple addons at a time.",
            "examples": [true],
            "title": "The Parallel Schema",
            "type": "boolean"
          },
          "show_output": {
            "$id": "#/properties/scripts/properties//properties/show_output",
            "default": false,
            "description": "All output is hidden by default. Setting show_output will display the command being executed and its output.",
            "examples": [true],
            "title": "The Show_output Schema",
            "type": "boolean"
          },
          "steps": {
            "$id": "#/properties/scripts/properties//properties/steps",
            "default": null,
            "items": {
              "$id": "#/properties/scripts/properties//properties/steps/items",
              "default": "",
              "examples": ["echo {{addon}} took {{time}} ms to build."],
              "pattern": "^(.*)$",
              "title": "The Items Schema",
              "type": "string"
            },
            "title": "The Steps Schema",
            "type": "array"
          },
          "steps_linux": {
            "$id": "#/properties/scripts/properties//properties/steps_linux",
            "default": null,
            "description": "steps_windows and steps_linux can be used to run different steps on the respective platforms.",
            "items": {
              "$id": "#/properties/scripts/properties//properties/steps_linux/items",
              "default": "",
              "examples": [""],
              "pattern": "^(.*)$",
              "title": "The Items Schema",
              "type": "string"
            },
            "title": "The Steps_linux Schema",
            "type": "array"
          },
          "steps_windows": {
            "$id": "#/properties/scripts/properties//properties/steps_windows",
            "default": null,
            "description": "steps_windows and steps_linux can be used to run different steps on the respective platforms.",
            "items": {
              "$id": "#/properties/scripts/properties//properties/steps_windows/items",
              "default": "",
              "examples": [""],
              "pattern": "^(.*)$",
              "title": "The Items Schema",
              "type": "string"
            },
            "title": "The Steps_windows Schema",
            "type": "array"
          }
        },
        "title": "The  Schema",
        "type": "object"
      },
      "default": null,
      "title": "The Scripts Schema",
      "type": "object"
    },
    "signame": {
      "$id": "#/properties/signame",
      "default": "",
      "description": "HEMTT will use the specified signature name as part of the full signature (.bisign) name. Supports templating.",
      "examples": ["my_custom_name"],
      "pattern": "^(.*)$",
      "title": "The Signame Schema",
      "type": "string"
    },
    "sigversion": {
      "$id": "#/properties/sigversion",
      "default": 2,
      "description": "HEMTT will use the specified signature version. Currently Supported: V2, V3 (Experimental).",
      "examples": [3],
      "title": "The Sigversion Schema",
      "type": "integer"
    },
    "skip": {
      "$id": "#/properties/skip",
      "default": null,
      "description": "HEMTT will skip building the specified addons.",
      "items": {
        "$id": "#/properties/skip/items",
        "default": "",
        "examples": ["hearing", "zeus"],
        "pattern": "^(.*)$",
        "title": "The Items Schema",
        "type": "string"
      },
      "title": "The Skip Schema",
      "type": "array"
    },
    "version": {
      "$id": "#/properties/version",
      "default": "",
      "description": "HEMTT will look for ```addons/main/script_version.hpp``` and use it for the version number. If you are not using the CBA project structure or do not have that file you can add a version number in the HEMTT project file.",
      "examples": ["1.0.0.0"],
      "pattern": "^(.*)$",
      "title": "The Version Schema",
      "type": "string"
    }
  },
  "required": ["name", "prefix", "author"],
  "title": "The Root Schema",
  "type": "object"
}
