{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://json.schemastore.org/amplify.json",
  "title": "AWS Amplify build specification (amplify.yml)",
  "type": "object",
  "properties": {
    "version": {
      "description": "Schema version (integer as in AWS examples)",
      "type": "integer"
    },
    "env": {
      "type": "object",
      "properties": {
        "variables": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "additionalProperties": true
    },
    "backend": {
      "type": "object",
      "properties": {
        "phases": {
          "type": "object",
          "patternProperties": {
            ".*": {
              "$ref": "#/definitions/phase"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": true
    },
    "frontend": {
      "type": "object",
      "properties": {
        "buildpath": {
          "type": "string"
        },
        "phases": {
          "type": "object",
          "patternProperties": {
            ".*": {
              "$ref": "#/definitions/phase"
            }
          },
          "additionalProperties": false
        },
        "artifacts": {
          "type": "object",
          "properties": {
            "files": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "discard-paths": {
              "type": "boolean"
            },
            "baseDirectory": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "cache": {
          "type": "object",
          "properties": {
            "paths": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": true
    },
    "test": {
      "type": "object",
      "properties": {
        "phases": {
          "type": "object",
          "patternProperties": {
            ".*": {
              "$ref": "#/definitions/phase"
            }
          },
          "additionalProperties": false
        },
        "artifacts": {
          "type": "object",
          "properties": {
            "files": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "configFilePath": {
              "type": "string"
            },
            "baseDirectory": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": true
    }
  },
  "definitions": {
    "phase": {
      "type": "object",
      "properties": {
        "commands": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "runtime-versions": {
          "description": "Optional object to specify runtime versions (e.g. nodejs: 12)",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": true,
  "examples": [
    {
      "version": 1,
      "env": {
        "variables": {
          "key": "value"
        }
      },
      "backend": {
        "phases": {
          "preBuild": {
            "commands": ["enter command"]
          },
          "build": {
            "commands": ["enter command"]
          },
          "postBuild": {
            "commands": ["enter command"]
          }
        }
      },
      "frontend": {
        "buildpath": "",
        "phases": {
          "preBuild": {
            "commands": ["cd react-app", "npm ci"]
          },
          "build": {
            "commands": ["npm run build"]
          }
        },
        "artifacts": {
          "files": ["location"],
          "discard-paths": true,
          "baseDirectory": "location"
        },
        "cache": {
          "paths": ["path"]
        }
      },
      "test": {
        "phases": {
          "preTest": {
            "commands": ["enter command"]
          },
          "test": {
            "commands": ["enter command"]
          },
          "postTest": {
            "commands": ["enter command"]
          }
        },
        "artifacts": {
          "files": ["location"],
          "configFilePath": "location",
          "baseDirectory": "location"
        }
      }
    }
  ]
}
