{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Static Analysis Results Format (SARIF) Version 1.0 JSON Schema (Draft 1.0.0-beta.3)",
  "description": "Static Analysis Results Format (SARIF) Version 1.0 JSON Schema (Draft 1.0.0-beta.3): a standard format for the output of static analysis and other tools.",
  "additionalProperties": false,
  "type": "object",
  "properties": {
    "version": 
    {
      "description": "The SARIF format version of this log file.",
      "enum": ["1.0.0-beta.3"]
    },

    "runs": 
    {
      "description": "The set of runs contained in this log file.",
      "type": "array",
      "minItems": 1,
      "items":
      {
        "$ref": "#/definitions/run"
      }
    }
  },
  "required": ["version", "runs"],
  "definitions":
  {
    "annotatedCodeLocation": 
    {
      "description": "A code annotation that consists of single physical location and associated message, used to express stacks, code flows through a method, or other locations that are related to a result.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "physicalLocation": 
        {
          "description": "A code location to which this annotation refers.",
          "$ref": "#/definitions/physicalLocation"
        },

        "message": {
          "description": "A message associated with this annotation, if applicable.",
          "type": "string"
        },

        "properties": 
        {
          "description": "Key/value pairs that provide additional details about the code location.",
          "type": "object",
          "default": {}
        },

        "tags": 
        {
          "description": "A unique set of strings that provide additional information for the associated code location.",
          "type": "array",
          "items":
          {
            "type": "string",
            "default": []
          }
        }
      },
      "required": ["physicalLocation"]
    },
    "fileChange": 
    {
      "description": "A change to a single file.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "uri": 
        {
          "description": "A string that represents the location of the file to change as a valid URI.",
          "type": "string",
          "format": "uri"
        },

        "replacements": 
        {
          "description": "An array of replacement objects, each of which represents the replacement of a single range of bytes in a single file specified by 'uri'.",
          "type": "array",
          "minItems": 1,
          "items":
          {
            "$ref": "#/definitions/replacement"
          }
        }
      },
      "required": ["uri", "replacements"]
    },
    "fileData": {
      "description": "A single file. In some cases, this file might be nested within another file.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "pathFromParent": {
          "description": "The path to the file within its containing file.",
          "type": "string"
        },

        "offsetFromParent": {
          "description": "The offset in bytes of the file within its containing file.",
          "type": "integer"
        },

        "length": {
          "description": "The length of the file in bytes.",
          "type": "integer"
        },

        "mimeType": {
          "description": "The MIME type (RFC 2045) of the file.",
          "type": "string",
          "pattern": "[^/]+/.+"
        },

        "hashes": {
          "description": "An array of hash objects, each of which specifies a hashed value for the file, along with the name of the algorithm used to compute the hash.",
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/definitions/hash"
          }
        },

        "properties": {
          "description": "Key/value pairs that provide additional information about the file.",
          "type": "object",
          "default": { }
        },

        "tags": {
          "description": "A set of distinct strings that provide additional information about the file.",
          "type": "array",
          "items": {
            "type": "string",
            "default": [ ]
          }
        }
      }
    },
    "fix": 
    {
      "description": "A proposed fix for the problem represented by a result object. A fix specifies a set of file to modify. For each file, it specifies a set of bytes to remove, and provides a set of new bytes to replace them.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "description": 
        {
          "description": "A string that describes the proposed fix, enabling viewers to present a proposed change to an end user.",
          "type": "string"
        },

        "fileChanges": 
        {
          "description": "A message associated with this annotation, if applicable.",
          "type": "array",
          "items":
          {
            "$ref": "#/definitions/fileChange"
          }
        }
      },
      "required": ["description", "fileChanges"]
    },
    "formattedMessage": 
    {
      "description": "Contains information that can be used to construct a formatted message that describes a result.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "formatId": 
        {
          "description": "A string that identifies the message format used to format the message that describes this result. The value of formatId must correspond to one of the names in the set of name/value pairs contained in the 'messageFormats' property of the rule object whose 'id' property matches the 'ruleId' property of this result.",
          "type": "string"
        },

        "arguments": 
        {
          "description": "An array of strings that will be used, in combination with a message format, to construct a result message.",
          "type": "array",
          "items":
          {
            "type": "string"
          }
        }
      },
      "required": ["formatId"]
    },
    "hash": 
    {
      "description": "A hash value of some file or collection of files, together with the algorithm used to compute the hash.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "value": 
        {
          "description": "The hash value of some file or collection of files, computed by the algorithm named in the 'algorithm' property.",
          "type": "string"
        },

        "algorithm": 
        {
          "description": "A string specifying the name of the algorithm used to compute the hash value specified in the 'value' property.",
          "enum": [ "BLAKE-256","BLAKE-512","ECOH","FSB","GOST","Groestl","HAS-160","HAVAL","JH","MD2","MD4","MD5","MD6","RadioGatun","RIPEMD","RIPEMD-128","RIPEMD-160","RIPEMD-320","SHA-1","SHA-224","SHA-256","SHA-384","SHA-512","SHA-3","Skein","Snefru","Spectral Hash","SWIFFT","Tiger","Whirlpool"]
        }
      },
      "required": ["value", "algorithm"]
    },
    "location": 
    {
      "description": "The location where an analysis tool produced a result.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "analysisTarget": 
        {
          "description": "Identifies the file that the analysis tool was instructed to scan. This need not be the same as the file where the result actually occurred.",
          "$ref": "#/definitions/physicalLocation"
        },

        "resultFile": 
        {
          "description": "Identifies the file where the analysis tool produced the result.",
          "$ref": "#/definitions/physicalLocation"
        },

        "logicalLocation": 
        {
          "description": "The logical location where the analysis tool produced the result.",
          "type": "array",
          "items":
          {
            "$ref": "#/definitions/logicalLocationComponent"
          }
        },

        "fullyQualifiedLogicalName": 
        {
          "description": "A string that summarizes the information in logicalLocation in a format consistent with the programming language in which the programmatic constructs expressed by logicalLocation were expressed.",
          "type": "string"
        },

        "properties": 
        {
          "description": "Key/value pairs that provide additional information about the location.",
          "type": "object",
          "default": {}
        },

        "tags": {
          "description": "A set of distinct strings that provide additional information about the location.",
          "type": "array",
          "items": {
            "type": "string",
            "default": [ ]
          }
        }
      }
    },
    "logicalLocationComponent": 
    {
      "description": "A component of a logical location.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "name": 
        {
          "description": "Identifies the construct in which the result occurred. For example, this property might contain the name of a class or a method.",
          "type": "string"
        },

        "kind": {
          "description": "The type of construct this logicalLocationComponent refers to. Should be one of 'assembly', 'attribute', 'binary', 'class', 'enum', 'field', 'lambda', 'local', 'method', 'module', 'namespace', 'package', 'parameter', 'property', 'resource', or, 'struct', if any of those accurately describe the construct.",
          "type": "string"
        }
      },
      "required": ["name"]
    },
    "physicalLocation": 
    {
      "description": "The physical location where a result was detected. Specifies a reference to a programming artifact together with a range of bytes or characters within that artifact.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "uri": 
        {
          "description": "The location of the file as a valid URI.",
          "type": "string",
          "format": "uri"
        },

        "region": 
        {
          "description": "The region within the file where the result was detected.",
          "$ref": "#/definitions/region"
        }
      },
      "required": ["uri"]
    },
    "region": 
    {
      "description": "A region within a file where a result was detected.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "startLine": 
        {
          "description": "The line number of the first character in the region.",
          "type": "integer",
          "minimum": 1
        },

        "startColumn": 
        {
          "description": "The column number of the first character in the region.",
          "type": "integer",
          "minimum": 1
        },

        "endLine": 
        {
          "description": "The line number of the last character in the region.",
          "type": "integer",
          "minimum": 1
        },

        "endColumn": 
        {
          "description": "The column number of the last character in the region.",
          "type": "integer",
          "minimum": 1
        },

        "offset": {
          "description": "The zero-based offset from the beginning of the file of the first byte or character in the region.",
          "type": "integer",
          "minimum": 0
        },

        "length": 
        {
          "description": "The length of the region in bytes or characters.",
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "replacement": 
    {
      "description": "The replacement of a single range of bytes in a file. Specifies the location within the file where the replacement is to be made, the number of bytes to remove at that location, and a sequence of bytes to insert at that location.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "offset": 
        {
          "description": "A non-negative integer specifying the offset in bytes from the beginning of the file at which bytes are to be removed, inserted or both. An offset of 0 shall denote the first byte in the file.",
          "type": "integer",
          "minimum": 0
        },

        "deletedLength": 
        {
          "description": "The number of bytes to delete, starting at the byte offset specified by offset, measured from the beginning of the file.",
          "type": "integer",
          "minimum": 1
        },

        "insertedBytes": 
        {
          "description": "The byte sequence to be inserted at the byte offset specified by the 'offset' property, measured from the beginning of the file.",
          "type": "string"
        }
      },
      "required": ["offset"]
    },
    "result": 
    {
      "description": "A result produced by an analysis tool.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "ruleId": 
        {
          "description": "A stable, opaque identifier for the rule that was evaluated to produce the result.",
          "type": "string"
        },

        "kind": 
        {
          "description": "The kind of observation this result represents. If this property is not present, its implied value is 'warning'.",
          "default": "warning",
          "enum": [ "pass", "warning", "error", "notApplicable", "configurationError", "internalError", "note" ]
        },

        "fullMessage": 
        {
          "description": "A string that describes the result.",
          "type": "string"
        },

        "shortMessage": 
        {
          "description": "A string that describes the result, displayed when visible space is limited to a single line of text.",
          "type": "string"
        },

        "formattedMessage": 
        {
          "description": "A 'formattedMessage' object that can be used to construct a formatted message that describes the result. If the 'formattedMessage' property is present on a result, the 'fullMessage' property shall not be present. If the 'fullMessage' property is present on an result, the 'formattedMessage' property shall not be present",
          "$ref": "#/definitions/formattedMessage"
        },

        "locations": 
        {
          "description": "One or more locations where the result occurred. Specify only one location unless the problem indicated by the result can only be corrected by making a change at every specified location.",
          "type": "array",
          "minItems": 1,
          "items":
          {
            "$ref": "#/definitions/location"
          }
        },

        "toolFingerprint": 
        {
          "description": "A string that contributes to the unique identity of the result.",
          "type": "string"
        },

        "stacks": 
        {
          "description": "An array of arrays of 'annotatedCodeLocation' objects, each inner array of which comprises a call stack.",
          "type": "array",
          "minItems": 1,
          "items":
          {
            "type": "array",
            "minItems": 1,
            "items":
            {
              "$ref": "#/definitions/annotatedCodeLocation"
            }
          }
        },

        "codeFlows": 
        {
          "description": "An array of arrays of 'annotatedCodeLocation` objects, each inner array of which comprises a code flow (a possible execution path through the code).",
          "type": "array",
          "minItems": 1,
          "items":
          {
            "type": "array",
            "minItems": 1,
            "items":
            {
              "$ref": "#/definitions/annotatedCodeLocation"
            }
          }
        },

        "relatedLocations": 
        {
          "description": "A grouped set of locations and messages, if available, that represent code areas that are related to this result.",
          "type": "array",
          "minItems": 1,
          "items":
          {
            "$ref": "#/definitions/annotatedCodeLocation"
          }
        },

        "isSuppressedInSource": 
        {
          "description": "A flag indicating whether or not this result was suppressed in source code.",
          "type": "boolean"
        },

        "fixes": 
        {
          "description": "An array of 'fix' objects, each of which represents a proposed fix to the problem indicated by the result.",
          "type": "array",
          "minItems": 1,
          "items":
          {
            "$ref": "#/definitions/fix"
          }
        },

        "properties": 
        {
          "description": "Key/value pairs that provide additional information about the result.",
          "type": "object",
          "default": {}
        },

        "tags": 
        {
          "description": "A set of distinct strings that provide additional information about the result.",
          "type": "array",
          "items":
          {
            "type": "string",
            "default": []
          }
        }
      }
    },
    "rule": 
    {
      "description": "Describes an analysis rule.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "id": 
        {
          "description": "A stable, opaque identifier for the rule.",
          "type": "string"
        },

        "name": 
        {
          "description": "A rule identifier that is understandable to an end user.",
          "type": "string"
        },

        "shortDescription": 
        {
          "description": "A concise description of the rule. Should be a single sentence that is understandable when visible space is limited to a single line of text.",
          "type": "string"
        },

        "fullDescription": 
        {
          "description": "A string that describes the rule. Should, as far as possible, provide details sufficient to enable resolution of any problem indicated by the result.",
          "type": "string"
        },

        "options": 
        {
          "description": "A dictionary consisting of a set of name/value pairs with arbitrary names. Describes the set of configurable options supported by the rule. The value within each name/value pair shall be a string, which may be the empty string. The value shall not be a dictionary or sub-object.",
          "type": "object"
        },

        "messageFormats": 
        {
          "description": "A set of name/value pairs with arbitrary names. The value within each name/value pair shall consist of plain text interspersed with placeholders, which can be used to format a message in combination with an arbitrary number of additional string arguments.",
          "type": "object"
        },

        "helpUri": 
        {
          "description": "A URI where the primary documentation for the rule can be found.",
          "type": "string",
          "format": "uri"
        },

        "properties": 
        {
          "description": "Key/value pairs that provide additional information about the rule.",
          "type": "object",
          "default": {}
        },

        "tags": {
          "description": "A set of distinct strings that provide additional information about the rule.",
          "type": "array",
          "items": {
            "type": "string",
            "default": [ ]
          }
        }
      },
      "required": ["id"]
    },
    "run": 
    {
      "description": "Describes a single run of an analysis tool, and contains the output of that run.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "tool": {
          "description": "Information about the tool or tool pipeline that generated the results in this run. A run can only contain results produced by a single tool or tool pipeline. A run can aggregate results from multiple log files, as long as context around the tool run (tool command-line arguments and the like) is identical for all aggregated files.",
          "$ref": "#/definitions/tool"
        },

        "invocation": {
          "description": "A string containing the runtime parameters with which the tool was invoked. For command line tools, this string may consist of the completely specified command line used to invoke the tool.",
          "type": "string"
        },

        "files": {
          "description": "A dictionary, each of whose keys is a URI and each of whose values is an array of file objects representing the location of a single file scanned during the run.",
          "type": "object",
          "additionalProperties": {
            "type": "array",
            "items": {
              "$ref": "#/definitions/fileData"
            }
          }
        },

        "results": {
          "description": "The set of results contained in an SARIF log. The results array can be omitted when a run is solely exporting rules metadata. It must be present (but may be empty) in the event that a log file represents an actual scan.",
          "type": "array",
          "minItems": 0,
          "items": {
            "$ref": "#/definitions/result"
          }
        },

        "rules": {
          "description": "An array of 'rule' objects that describe all rules associated with an analysis tool or a specific run of an analysis tool.",
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/definitions/rule"
          }
        },

        "startTime": {
          "description": "The date and time at which the run started. See \"Date/time properties\" in the SARIF spec for the required format.",
          "type": "string",
          "format": "date-time"
        },

        "endTime": {
          "description": "The date and time at which the run ended. See \"Date/time properties\" in the  SARIF spec for the required format.",
          "type": "string",
          "format": "date-time"
        },

        "correlationId": {
          "description": "An identifier that allows the run to be correlated with other artifacts produced by a larger automation process.",
          "type": "string"
        },

        "architecture": {
          "description": "An identifier that specifies the hardware architecture for which the run was targeted.",
          "type": "string"
        },

        "properties": {
          "description": "Key/value pairs that provide additional information about the run.",
          "type": "object",
          "default": { }
        },

        "tags": {
          "description": "A set of distinct strings that provide additional information about the run.",
          "type": "array",
          "items": {
            "type": "string",
            "default": [ ]
          }
        }
      },
      "required": [ "tool" ]
    },
    "tool": 
    {
      "description": "The analysis tool that was run.",
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "name": 
        {
          "description": "The name of the tool.",
          "type": "string"
        },

        "fullName": 
        {
          "description": "The name of the tool along with its version and any other useful identifying information, such as its locale.",
          "type": "string"
        },

        "version": 
        {
          "description": "The tool version.",
          "type": "string"
        },

        "fileVersion": {
          "description": "The binary version of the tool's primary executable file (for operating systems such as Windows that provide that information).",
          "type": "string",
          "pattern": "[0-9]+(\\.[0-9]+){3}"
        }
      },
      "required": ["name"]
    }
  }
}
