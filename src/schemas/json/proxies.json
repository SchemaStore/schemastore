{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "additionalProperties": false,
  "definitions": {
    "http-method-schema": {
      "enum": [
        "GET",
        "POST",
        "HEAD",
        "OPTIONS",
        "PUT",
        "TRACE",
        "DELETE",
        "PATCH",
        "CONNECT"
      ]
    },
    "match-condition-schema": {
      "additionalProperties": false,
      "properties": {
        "methods": {
          "description": "This is an array of the HTTP methods to which the proxy will respond. If not specified, the proxy will respond to all HTTP methods on the route.",
          "items": {
            "$ref": "#/definitions/http-method-schema"
          },
          "minItems": 1,
          "type": "array",
          "uniqueItems": true
        },
        "route": {
          "description": "Required - This defines the route template, controlling to which request URLs your proxy will respond. Unlike in HTTP triggers, there is no default value",
          "type": "string"
        }
      },
      "required": ["route"],
      "type": "object"
    },
    "proxy-schema": {
      "additionalProperties": false,
      "default": {
        "backendUri": "",
        "matchCondition": {
          "route": ""
        }
      },
      "properties": {
        "backendUri": {
          "description": "The URL of the backend resource to which the request should be proxied. This value may be templated. If this property is not included, Azure Functions will respond with an HTTP 200 OK",
          "type": "string"
        },
        "debug": {
          "type": "boolean"
        },
        "desc": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "disabled": {
          "type": "boolean"
        },
        "matchCondition": {
          "$ref": "#/definitions/match-condition-schema",
          "description": "Required - an object defining the requests that will trigger the execution of this proxy. It contains two properties shared with HTTP triggers - methods and route"
        },
        "requestOverrides": {
          "$ref": "#/definitions/requestOverrides-schema",
          "description": "The requestOverrides object defines changes made to the request when the backend resource is called. You can make changes to the HTTP method, headers, and query string parameters."
        },
        "responseOverrides": {
          "$ref": "#/definitions/responseOverrides-schema",
          "description": "The responseOverrides object defines changes made to the response passed back to the client. You can make changes to the response's status code, reason phrase, headers, and body."
        }
      },
      "required": ["matchCondition"],
      "type": "object"
    },
    "request-overrides-value-expression-schema": {
      "defaultSnippets": [
        {
          "body": "{request.headers.<HeaderName>}",
          "description": "Read from one of the request headers",
          "label": "Original Request Header"
        },
        {
          "body": "{request.querystring.<ParameterName>}",
          "description": "Read one of the original request query string parameters",
          "label": "Original Request Query String Parameter"
        },
        {
          "body": "{request.method}",
          "description": "Read the request method",
          "label": "Original Request Method"
        }
      ],
      "type": "string"
    },
    "requestOverrides-schema": {
      "additionalProperties": false,
      "patternProperties": {
        "^backend\\.request\\.headers\\..+$": {
          "$ref": "#/definitions/request-overrides-value-expression-schema",
          "description": "A header which can be set for the call to the backend. Values can reference application settings, parameters from the original client request, and parameters from the backend response. If the empty string is provided, the header will not be included on the backend request."
        },
        "^backend\\.request\\.querystring\\..+$": {
          "$ref": "#/definitions/request-overrides-value-expression-schema",
          "description": "A query string parameter which can be set for the call to the backend. Values can reference application settings and parameters from the original client request. If the empty string is provided, the parameter will not be included on the backend request"
        }
      },
      "properties": {
        "backend.request.headers.<HeaderName>": {
          "$ref": "#/definitions/request-overrides-value-expression-schema",
          "description": "A header which can be set for the call to the backend. Replace \"<HeaderName>\" with the name of the header you wish to set. If the empty string is provided, the header will not be included on the backend request."
        },
        "backend.request.method": {
          "anyOf": [
            {
              "$ref": "#/definitions/http-method-schema"
            },
            {
              "$ref": "#/definitions/request-overrides-value-expression-schema"
            }
          ],
          "description": "This is the HTTP method which will be used to call the backend."
        },
        "backend.request.querystring.<ParameterName>": {
          "$ref": "#/definitions/request-overrides-value-expression-schema",
          "description": "A query string parameter which can be set for the call to the backend. Replace \"<ParameterName>\" with the name of the parameter you wish to set. If the empty string is provided, the parameter will not be included on the backend request"
        }
      },
      "type": "object"
    },
    "response-overrides-value-expression-schema": {
      "defaultSnippets": [
        {
          "body": "{backend.response.headers.<HeaderName>}",
          "description": "Read from one of the backend response headers",
          "label": "Backend Response Header"
        },
        {
          "body": "{backend.response.statusCode}",
          "description": "Read the backend response status code.",
          "label": "Backend Response Status Code"
        },
        {
          "body": "{backend.response.statusReason}",
          "description": "Read the backend response status reason.",
          "label": "Backend Response Status Reason"
        },
        {
          "body": "{request.headers.<HeaderName>}",
          "description": "Read from one of the original request headers",
          "label": "Original Request Header"
        },
        {
          "body": "{request.querystring.<ParameterName>}",
          "description": "Read one of the original request query string parameters",
          "label": "Original Request Query String"
        },
        {
          "body": "{request.method}",
          "description": "Read the original request method",
          "label": "Original Request Method"
        },
        {
          "body": "{backend.request.headers.<HeaderName>}",
          "description": "Read from backend request headers",
          "label": "Backend Request Header"
        },
        {
          "body": "{backend.request.querystring.<ParameterName>}",
          "description": "Read one of the backend request query string parameters",
          "label": "Backend Request Query String"
        },
        {
          "body": "{backend.request.method}",
          "description": "Read the backend request method",
          "label": "Backend Request Method"
        }
      ],
      "type": "string"
    },
    "responseOverrides-schema": {
      "additionalProperties": false,
      "patternProperties": {
        "^response\\.headers\\..+$": {
          "$ref": "#/definitions/response-overrides-value-expression-schema",
          "description": "A header which can be set for the response to the client. Values can reference application settings, parameters from the original client request, and parameters from the backend response. If the empty string is provided, the header will not be included on the response."
        }
      },
      "properties": {
        "response.body": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "object"
            },
            {
              "items": {
                "type": "object"
              },
              "minItems": 1,
              "type": "array"
            }
          ],
          "description": "The string representation of the body to be returned to the client."
        },
        "response.headers.<HeaderName>": {
          "$ref": "#/definitions/response-overrides-value-expression-schema",
          "description": "A header which can be set for the response to the client. Replace \"<HeaderName>\" with the name of the header you wish to set. If the empty string is provided, the header will not be included on the response."
        },
        "response.statusCode": {
          "$ref": "#/definitions/response-overrides-value-expression-schema",
          "description": "The HTTP status code to be returned to the client."
        },
        "response.statusReason": {
          "$ref": "#/definitions/response-overrides-value-expression-schema",
          "description": "The HTTP reason phrase to be returned to the client."
        }
      },
      "type": "object"
    }
  },
  "properties": {
    "$schema": {
      "type": "string"
    },
    "proxies": {
      "additionalProperties": {
        "$ref": "#/definitions/proxy-schema",
        "description": "A friendly name for the proxy"
      },
      "description": "The proxies object defines the proxies that will be used by the function app",
      "properties": {
        "<ProxyName>": {
          "$ref": "#/definitions/proxy-schema",
          "description": "Default template for a proxy. Replace \"<ProxyName>\" with a friendly name you wish to set."
        }
      },
      "type": "object"
    }
  },
  "required": ["proxies"],
  "title": "JSON schema for Azure Functions Proxies proxies.json files",
  "type": "object"
}
