# yaml-language-server: $schema=../../schemas/json/opensrm.json
apiVersion: srm/v1
kind: ServiceReliabilityManifest
metadata:
  name: security-scanner
  team: security
  tier: critical
spec:
  type: ai-gate
  contract:
    availability: 0.999
    latency:
      p99: 60s
    judgment:
      max_reversal_rate: 0.05
      max_hcf_rate: 0.02
      max_feedback_latency: 7d
  slos:
    availability:
      target: 0.9995
      window: 30d
    latency:
      p99: 45s
      target: 0.99
      window: 30d
    judgment:
      reversal_rate:
        target: 0.03
        window: 30d
        observation_period: 7d
      high_confidence_failure:
        target: 0.01
        confidence_threshold: 0.85
        window: 30d
      calibration:
        target: 0.12
        window: 30d
      feedback_latency:
        p50: 4h
        p90: 48h
  dependencies:
    - service: llm-gateway
      type: external
      critical: true
      expects:
        availability: 0.999
        latency:
          p99: 30s
  ownership:
    team: security
    slack: '#security-oncall'
    runbook: https://wiki.example.com/runbooks/security-scanner
    oncall_required: true
  instrumentation:
    events:
      decision: ai_gate.decision
      reversal: ai_gate.reversal
      outcome: ai_gate.outcome
    attributes:
      decision_id: ai_gate.decision_id
      confidence: ai_gate.confidence
      decision: ai_gate.decision
